<Window x:Class="InvestigateZoomLevel.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:InvestigateZoomLevel"
        mc:Ignorable="d"
        Title="Rich Text Editor - Zoom Level Implementations" Height="700" Width="1100">
    <Window.Resources>
        <!-- Style for limitation sections -->
        <Style x:Key="LimitationBoxStyle" TargetType="Border">
            <Setter Property="Background" Value="#FFF9E6"/>
            <Setter Property="BorderBrush" Value="#FFB700"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="5"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Margin" Value="10,5,10,10"/>
        </Style>
        
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#CC8800"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
        </Style>
        
        <Style x:Key="ZoomControlStyle" TargetType="StackPanel">
            <Setter Property="Orientation" Value="Horizontal"/>
            <Setter Property="Margin" Value="10,5,10,5"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="15">
            <StackPanel>
                <TextBlock Text="Rich Text Editor - Zoom Level Implementations" 
                          FontSize="20" FontWeight="Bold" Foreground="White"/>
                <TextBlock Text="Each tab demonstrates a different approach to implementing zoom functionality" 
                          FontSize="12" Foreground="#BDC3C7" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>
        
        <!-- Tab Control -->
        <TabControl Grid.Row="1" Margin="5">
            
            <!-- Tab 1: LayoutTransform (Simple) -->
            <TabItem Header="1. LayoutTransform (Simple)">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Limitations Box -->
                    <Border Grid.Row="0" Style="{StaticResource LimitationBoxStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderTextStyle}">
                                <Run Text="ℹ️ Implementation: LayoutTransform on RichTextBox"/>
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap">
                                <Run Text="✓ Advantages: Simple, straightforward WPF approach"/>
                                <LineBreak/>
                                <Run Text="✓ Built-in ScrollViewer handles scrolling automatically"/>
                                <LineBreak/>
                                <Run Text="✓ Works seamlessly with all RichTextBox features"/>
                                <LineBreak/>
                                <Run Text="✗ Limitations: May affect layout calculations"/>
                                <LineBreak/>
                                <Run Text="✗ Parent container must accommodate scaled size"/>
                                <LineBreak/>
                                <Run Text="📝 Usage: Use slider or preset buttons to adjust zoom"/>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                    
                    <!-- Zoom Controls -->
                    <StackPanel Grid.Row="1" Style="{StaticResource ZoomControlStyle}">
                        <TextBlock Text="Zoom Level:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                        <Button Content="50%" Width="50" Margin="2" Click="ZoomNative_Click" Tag="0.5"/>
                        <Button Content="75%" Width="50" Margin="2" Click="ZoomNative_Click" Tag="0.75"/>
                        <Button Content="90%" Width="50" Margin="2" Click="ZoomNative_Click" Tag="0.9"/>
                        <Button Content="100%" Width="50" Margin="2" Click="ZoomNative_Click" Tag="1.0" FontWeight="Bold"/>
                        <Button Content="125%" Width="50" Margin="2" Click="ZoomNative_Click" Tag="1.25"/>
                        <Button Content="150%" Width="50" Margin="2" Click="ZoomNative_Click" Tag="1.5"/>
                        <Button Content="200%" Width="50" Margin="2" Click="ZoomNative_Click" Tag="2.0"/>
                        <Slider x:Name="SliderNativeZoom" Width="150" Minimum="0.5" Maximum="3.0" 
                                Value="1.0" VerticalAlignment="Center" Margin="10,0,5,0"
                                ValueChanged="SliderNativeZoom_ValueChanged"/>
                        <TextBlock x:Name="TxtNativeZoom" Text="100%" VerticalAlignment="Center" 
                                  MinWidth="50" FontWeight="SemiBold"/>
                    </StackPanel>
                    
                    <!-- RichTextBox -->
                    <RichTextBox x:Name="RtbNative" Grid.Row="2" Margin="10" 
                                VerticalScrollBarVisibility="Auto" 
                                AcceptsTab="True"/>
                </Grid>
            </TabItem>
            
            <!-- Tab 2: ScaleTransform -->
            <TabItem Header="2. ScaleTransform">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Limitations Box -->
                    <Border Grid.Row="0" Style="{StaticResource LimitationBoxStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderTextStyle}">
                                <Run Text="ℹ️ Implementation: ScaleTransform with ScrollViewer"/>
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap">
                                <Run Text="✓ Advantages: Smooth scaling, no value limits"/>
                                <LineBreak/>
                                <Run Text="✓ Works at any zoom level"/>
                                <LineBreak/>
                                <Run Text="✓ Clean visual scaling"/>
                                <LineBreak/>
                                <Run Text="✗ Limitations: Scrollbars don't automatically adjust to content size"/>
                                <LineBreak/>
                                <Run Text="✗ May need manual scroll extent adjustments"/>
                                <LineBreak/>
                                <Run Text="📝 Usage: Use slider or preset buttons to adjust zoom"/>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                    
                    <!-- Zoom Controls -->
                    <StackPanel Grid.Row="1" Style="{StaticResource ZoomControlStyle}">
                        <TextBlock Text="Zoom Level:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                        <Button Content="50%" Width="50" Margin="2" Click="ZoomTransform_Click" Tag="0.5"/>
                        <Button Content="75%" Width="50" Margin="2" Click="ZoomTransform_Click" Tag="0.75"/>
                        <Button Content="90%" Width="50" Margin="2" Click="ZoomTransform_Click" Tag="0.9"/>
                        <Button Content="100%" Width="50" Margin="2" Click="ZoomTransform_Click" Tag="1.0" FontWeight="Bold"/>
                        <Button Content="125%" Width="50" Margin="2" Click="ZoomTransform_Click" Tag="1.25"/>
                        <Button Content="150%" Width="50" Margin="2" Click="ZoomTransform_Click" Tag="1.5"/>
                        <Button Content="200%" Width="50" Margin="2" Click="ZoomTransform_Click" Tag="2.0"/>
                        <Slider x:Name="SliderTransformZoom" Width="150" Minimum="0.5" Maximum="3.0" 
                                Value="1.0" VerticalAlignment="Center" Margin="10,0,5,0"
                                ValueChanged="SliderTransformZoom_ValueChanged"/>
                        <TextBlock x:Name="TxtTransformZoom" Text="100%" VerticalAlignment="Center" 
                                  MinWidth="50" FontWeight="SemiBold"/>
                    </StackPanel>
                    
                    <!-- ScrollViewer with ScaleTransform -->
                    <ScrollViewer Grid.Row="2" Margin="10" HorizontalScrollBarVisibility="Auto" 
                                 VerticalScrollBarVisibility="Auto">
                        <RichTextBox x:Name="RtbTransform" MinHeight="400" MinWidth="800"
                                    AcceptsTab="True">
                            <RichTextBox.LayoutTransform>
                                <ScaleTransform x:Name="ScaleTransformRtb" ScaleX="1.0" ScaleY="1.0"/>
                            </RichTextBox.LayoutTransform>
                        </RichTextBox>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            
            <!-- Tab 3: ViewBox Approach -->
            <TabItem Header="3. ViewBox Zoom">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Limitations Box -->
                    <Border Grid.Row="0" Style="{StaticResource LimitationBoxStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderTextStyle}">
                                <Run Text="ℹ️ Implementation: ViewBox with Width/Height Binding"/>
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap">
                                <Run Text="✓ Advantages: Container-based scaling approach"/>
                                <LineBreak/>
                                <Run Text="✓ Good for consistent scaling"/>
                                <LineBreak/>
                                <Run Text="✗ Limitations: May stretch content unexpectedly"/>
                                <LineBreak/>
                                <Run Text="✗ Less precise control over text rendering"/>
                                <LineBreak/>
                                <Run Text="✗ Scrolling behavior differs from native"/>
                                <LineBreak/>
                                <Run Text="📝 Usage: Use slider or preset buttons to adjust zoom"/>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                    
                    <!-- Zoom Controls -->
                    <StackPanel Grid.Row="1" Style="{StaticResource ZoomControlStyle}">
                        <TextBlock Text="Zoom Level:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                        <Button Content="50%" Width="50" Margin="2" Click="ZoomViewbox_Click" Tag="0.5"/>
                        <Button Content="75%" Width="50" Margin="2" Click="ZoomViewbox_Click" Tag="0.75"/>
                        <Button Content="90%" Width="50" Margin="2" Click="ZoomViewbox_Click" Tag="0.9"/>
                        <Button Content="100%" Width="50" Margin="2" Click="ZoomViewbox_Click" Tag="1.0" FontWeight="Bold"/>
                        <Button Content="125%" Width="50" Margin="2" Click="ZoomViewbox_Click" Tag="1.25"/>
                        <Button Content="150%" Width="50" Margin="2" Click="ZoomViewbox_Click" Tag="1.5"/>
                        <Button Content="200%" Width="50" Margin="2" Click="ZoomViewbox_Click" Tag="2.0"/>
                        <Slider x:Name="SliderViewboxZoom" Width="150" Minimum="0.5" Maximum="3.0" 
                                Value="1.0" VerticalAlignment="Center" Margin="10,0,5,0"
                                ValueChanged="SliderViewboxZoom_ValueChanged"/>
                        <TextBlock x:Name="TxtViewboxZoom" Text="100%" VerticalAlignment="Center" 
                                  MinWidth="50" FontWeight="SemiBold"/>
                    </StackPanel>
                    
                    <!-- ScrollViewer with Viewbox -->
                    <ScrollViewer Grid.Row="2" Margin="10" HorizontalScrollBarVisibility="Auto" 
                                 VerticalScrollBarVisibility="Auto">
                        <Viewbox x:Name="ViewboxContainer" Stretch="Fill" 
                                Width="800" Height="400" HorizontalAlignment="Left" VerticalAlignment="Top">
                            <RichTextBox x:Name="RtbViewbox" Width="800" Height="400"
                                        AcceptsTab="True"/>
                        </Viewbox>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            
            <!-- Tab 4: Auto-Zoom Based on Smallest Font -->
            <TabItem Header="4. Auto-Zoom (Smart)">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Limitations Box -->
                    <Border Grid.Row="0" Style="{StaticResource LimitationBoxStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderTextStyle}">
                                <Run Text="ℹ️ Implementation: Auto-Zoom Based on Smallest Font Size"/>
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap">
                                <Run Text="✓ Advantages: Automatically ensures smallest text is readable"/>
                                <LineBreak/>
                                <Run Text="✓ Dynamically adjusts zoom based on content"/>
                                <LineBreak/>
                                <Run Text="✓ User sets target minimum size"/>
                                <LineBreak/>
                                <Run Text="✗ Limitations: Requires analyzing all text in document"/>
                                <LineBreak/>
                                <Run Text="✗ Performance impact with very large documents"/>
                                <LineBreak/>
                                <Run Text="✗ Recalculation needed when content changes"/>
                                <LineBreak/>
                                <Run Text="📝 Usage: Set target minimum font size, click 'Auto-Zoom' to analyze and adjust"/>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                    
                    <!-- Zoom Controls -->
                    <StackPanel Grid.Row="1" Style="{StaticResource ZoomControlStyle}">
                        <TextBlock Text="Target Min Font Size:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                        <TextBox x:Name="TxtTargetFontSize" Width="50" Text="12" VerticalAlignment="Center" Margin="2"/>
                        <Button Content="Auto-Zoom" Width="90" Margin="5,2,2,2" Click="AutoZoom_Click" 
                                Background="#3498DB" Foreground="White" FontWeight="SemiBold"/>
                        <Button Content="Reset (100%)" Width="90" Margin="2" Click="AutoZoomReset_Click"/>
                        <Separator Width="20" Background="Transparent"/>
                        <TextBlock Text="Current Zoom:" VerticalAlignment="Center" Margin="10,0,5,0" FontWeight="SemiBold"/>
                        <TextBlock x:Name="TxtAutoZoom" Text="100%" VerticalAlignment="Center" 
                                  MinWidth="50" FontWeight="SemiBold" Foreground="#27AE60"/>
                        <TextBlock x:Name="TxtSmallestFont" Text="" VerticalAlignment="Center" 
                                  Margin="10,0,0,0" FontStyle="Italic" Foreground="#7F8C8D"/>
                    </StackPanel>
                    
                    <!-- RichTextBox with Auto-Zoom -->
                    <RichTextBox x:Name="RtbAutoZoom" Grid.Row="2" Margin="10" 
                                VerticalScrollBarVisibility="Auto" 
                                AcceptsTab="True"/>
                </Grid>
            </TabItem>
            
            <!-- Tab 5: Dropdown ComboBox Style (Google Docs-like) -->
            <TabItem Header="5. Dropdown (Google Docs Style)">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Limitations Box -->
                    <Border Grid.Row="0" Style="{StaticResource LimitationBoxStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderTextStyle}">
                                <Run Text="ℹ️ Implementation: ComboBox Dropdown (Google Docs Style)"/>
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap">
                                <Run Text="✓ Advantages: Familiar UI pattern (matches Google Docs)"/>
                                <LineBreak/>
                                <Run Text="✓ Clean, compact interface"/>
                                <LineBreak/>
                                <Run Text="✓ Fixed preset values prevent confusion"/>
                                <LineBreak/>
                                <Run Text="✗ Limitations: Limited to predefined zoom levels only"/>
                                <LineBreak/>
                                <Run Text="✗ No custom zoom values"/>
                                <LineBreak/>
                                <Run Text="📝 Usage: Select zoom level from dropdown"/>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                    
                    <!-- Zoom Controls -->
                    <StackPanel Grid.Row="1" Style="{StaticResource ZoomControlStyle}">
                        <TextBlock Text="Zoom:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                        <ComboBox x:Name="CmbZoomDropdown" Width="100" SelectedIndex="3"
                                 SelectionChanged="CmbZoomDropdown_SelectionChanged">
                            <ComboBoxItem Content="50%" Tag="0.5"/>
                            <ComboBoxItem Content="75%" Tag="0.75"/>
                            <ComboBoxItem Content="90%" Tag="0.9"/>
                            <ComboBoxItem Content="100%" Tag="1.0"/>
                            <ComboBoxItem Content="125%" Tag="1.25"/>
                            <ComboBoxItem Content="150%" Tag="1.5"/>
                            <ComboBoxItem Content="200%" Tag="2.0"/>
                        </ComboBox>
                    </StackPanel>
                    
                    <!-- RichTextBox -->
                    <RichTextBox x:Name="RtbDropdown" Grid.Row="2" Margin="10" 
                                VerticalScrollBarVisibility="Auto" 
                                AcceptsTab="True"/>
                </Grid>
            </TabItem>
            
            <!-- Tab 6: Ctrl + Mouse Wheel -->
            <TabItem Header="6. Ctrl + Mouse Wheel">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Limitations Box -->
                    <Border Grid.Row="0" Style="{StaticResource LimitationBoxStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderTextStyle}">
                                <Run Text="ℹ️ Implementation: Ctrl + Mouse Wheel (Interactive)"/>
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap">
                                <Run Text="✓ Advantages: Most intuitive zoom method"/>
                                <LineBreak/>
                                <Run Text="✓ Familiar to users (browsers, IDEs, etc.)"/>
                                <LineBreak/>
                                <Run Text="✓ Smooth, incremental zoom control"/>
                                <LineBreak/>
                                <Run Text="✓ No UI controls needed"/>
                                <LineBreak/>
                                <Run Text="✗ Limitations: May not be discoverable for all users"/>
                                <LineBreak/>
                                <Run Text="✗ Requires mouse with wheel"/>
                                <LineBreak/>
                                <Run Text="📝 Usage: Hold Ctrl and scroll mouse wheel up (zoom in) or down (zoom out)"/>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                    
                    <!-- Zoom Status -->
                    <StackPanel Grid.Row="1" Style="{StaticResource ZoomControlStyle}">
                        <TextBlock Text="Current Zoom:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                        <TextBlock x:Name="TxtMouseWheelZoom" Text="100%" VerticalAlignment="Center" 
                                  MinWidth="50" FontWeight="SemiBold" Foreground="#27AE60" FontSize="14"/>
                        <TextBlock Text="(Hold Ctrl + Scroll Mouse Wheel to zoom)" VerticalAlignment="Center" 
                                  Margin="20,0,0,0" FontStyle="Italic" Foreground="#7F8C8D"/>
                        <Button Content="Reset (100%)" Width="90" Margin="20,2,2,2" Click="MouseWheelZoomReset_Click"/>
                    </StackPanel>
                    
                    <!-- RichTextBox with Mouse Wheel Zoom -->
                    <RichTextBox x:Name="RtbMouseWheel" Grid.Row="2" Margin="10" 
                                VerticalScrollBarVisibility="Auto" 
                                AcceptsTab="True"
                                PreviewMouseWheel="RtbMouseWheel_PreviewMouseWheel"
                                Focusable="True"/>
                </Grid>
            </TabItem>
            
        </TabControl>
    </Grid>
</Window>
